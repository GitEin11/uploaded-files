javascript: (() => {
    let referenceWidth = document.querySelector(".kcerW9lbT-se3SXd-wp2i, ._1RYN-7H8gYctjOQeL8p2Q7").offsetWidth;
    if (referenceWidth > 700) {
        let widthelements = document.querySelectorAll('._3m20hIKOhTTeMgPnfMbVNN, ._1dwExqTGJH2jnA-MYGkEL-');
        for (var i = 0; i < widthelements.length; i++) {
            widthelements[i].style.maxWidth = (referenceWidth - 82) + 'px';
        }
    }

    function processImagereset() {
        let elements = document.querySelectorAll("._3hUbl08LBz2mbXjy0iYhOS,._3b8u2OJXaSDdBWoRB7zUoK");
        for (let element of elements) {
            let maximumHeight = 512;
            element.closest(".KVyBaj7FjzElWsqJDmw7v").style.maxHeight = maximumHeight + "px";
            element.closest(".m3aNC6yp8RrNM_-a0rrfa").style.maxHeight = maximumHeight + "px";
            element.closest(".KVyBaj7FjzElWsqJDmw7v").style.height = maximumHeight + "px";
            element.closest(".m3aNC6yp8RrNM_-a0rrfa").style.height = maximumHeight + "px";
        }
    }

    function processImageS() {
        let elements = document.querySelectorAll("._3hUbl08LBz2mbXjy0iYhOS,._3b8u2OJXaSDdBWoRB7zUoK");
        for (let element of elements) {
            element.style.visibility = "hidden";
            let parent = element.parentElement.parentElement.parentElement.parentElement;
            let maximumHeight = 512;
            let descendants = parent.getElementsByTagName("*");
            for (let descendant of descendants) {
                let height = descendant.offsetHeight;
                if (height > maximumHeight) {
                    maximumHeight = height;
                }
            }
            let current = element;
            while (current && !current.classList.contains(".m3aNC6yp8RrNM_-a0rrfa")) {
                if (current.offsetHeight == 512) {
                    current.style.setProperty("height", maximumHeight + "px", "important");
                    current.style.setProperty("maxHeight", maximumHeight + "px", "important");
                }
                current = current.parentElement;
            }
            let target = document.querySelector(".m3aNC6yp8RrNM_-a0rrfa,.KVyBaj7FjzElWsqJDmw7v");
            target.style.setProperty("height", maximumHeight + "px", "important");
            target.style.setProperty("maxHeight", maximumHeight + "px", "important");
            element.parentElement.style.maxHeight = maximumHeight + "px";
            element.closest(".m3aNC6yp8RrNM_-a0rrfa").style.maxHeight = maximumHeight + "px";
        }
    }

    function processImage() {
        var currentURL = window.location.href;
        var pattern = /^https:\/\/www\.reddit\.com\/r\/[^\/]+\/$/;
        if (pattern.test(currentURL)) {
            processImagereset();
        }
        let elements = document.querySelectorAll("._3hUbl08LBz2mbXjy0iYhOS,._3b8u2OJXaSDdBWoRB7zUoK");
        for (let element of elements) {
            element.style.visibility = "hidden";
            let ancestor = element.closest("._1NSbknF8ucHV2abfCZw2Z1");
            let viewFullImages = ancestor.querySelectorAll("._3hUbl08LBz2mbXjy0iYhOS,._3b8u2OJXaSDdBWoRB7zUoK");
            for (let i = 0; i < viewFullImages.length; i++) {
                let currentviewFullImage = viewFullImages[i];
                currentviewFullImage.style.visibility = "hidden";
            }
            let descendants = ancestor.querySelectorAll("._28TEYBuEdOuE3kN6UyoKMa");
            let descendant = null;
            for (let i = 0; i < descendants.length; i++) {
                let current = descendants[i];
                if (current.style.left === "0px") {
                    descendant = current;
                    break;
                }
            }
            let imageElement;
            if (descendant) {
                imageElement = descendant.querySelector("img");
            } else {
                imageElement = ancestor.querySelector("img");
            }
            let maximumHeight = 512;
            if (imageElement.offsetHeight > 512) {
                maximumHeight = imageElement.offsetHeight;
            }
            var currentURL2 = window.location.href;
            var pattern1 = /^https:\/\/www\.reddit\.com\/r\/[^\/]+\/$/;
            var pattern2 = /^https:\/\/www\.reddit\.com\/r\/[^\/]+\/comments\/.+/;
            if (pattern1.test(currentURL2)) {
                element.closest(".KVyBaj7FjzElWsqJDmw7v").style.maxHeight = maximumHeight + "px";
                element.closest(".m3aNC6yp8RrNM_-a0rrfa").style.maxHeight = maximumHeight + "px";
                element.closest(".KVyBaj7FjzElWsqJDmw7v").style.height = maximumHeight + "px";
                element.closest(".m3aNC6yp8RrNM_-a0rrfa").style.height = maximumHeight + "px";
            } else if (pattern2.test(currentURL)) {
                let current = element;
                while (current && !current.classList.contains(".m3aNC6yp8RrNM_-a0rrfa")) {
                    if (current.offsetHeight == 512) {
                        current.style.setProperty("height", maximumHeight + "px", "important");
                        current.style.setProperty("maxHeight", maximumHeight + "px", "important");
                    }
                    current = current.parentElement;
                }
                let target = document.querySelector(".m3aNC6yp8RrNM_-a0rrfa,.KVyBaj7FjzElWsqJDmw7v");
                target.style.setProperty("height", maximumHeight + "px", "important");
                target.style.setProperty("maxHeight", maximumHeight + "px", "important");
                element.parentElement.style.maxHeight = maximumHeight + "px";
                element.closest(".m3aNC6yp8RrNM_-a0rrfa").style.maxHeight = maximumHeight + "px";
            }
        }
    }
    let elementfs = document.querySelectorAll("._3hUbl08LBz2mbXjy0iYhOS,._3b8u2OJXaSDdBWoRB7zUoK");
    for (let elementf of elementfs) {
        let ancestorf = elementf.closest("._28TEYBuEdOuE3kN6UyoKMa");
        if (ancestorf) {
            processImage(elementf);
        } else {
            processImageS(elementf);
        }
    }
})();
